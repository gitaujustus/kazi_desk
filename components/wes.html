<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <img src="/static/pictures/tech_image.jpg" alt="Tech Image">
        </div>
        <div class="main-content">
            <h1>Functionalities</h1>
            <button class="button" onclick="toggleShutdownSection()">Remote Control</button>
            <button class="button" onclick="toggleFileTransfer()">File Transfer</button>
            <button class="button" onclick="showMessage('Desktop Sharing')">Desktop Sharing</button>
            <button class="button" onclick="showMessage('Messaging')">Messaging</button>

            <div id="fileTransferSection" style="display: none;">
                <h2>File Transfer</h2>
                <input type="file" id="fileInput">
                <button class="button" onclick="uploadFile()">Upload File</button>
                <br><br>
                <div id="fileList"></div>
            </div>

            <div id="shutdownSection" style="display: none;">
                <h2>Remote Shutdown</h2>
                <input type="text" id="ipAddress" placeholder="IP Address">
                <input type="text" id="username" placeholder="Username">
                <input type="password" id="password" placeholder="Password">
                <button class="button" onclick="shutdownRemoteMachine()">Shutdown</button>
            </div>
        </div>
    </div>

    <script>
        function showMessage(message) {
            alert(message);
        }

        function toggleFileTransfer() {
            const fileTransferSection = document.getElementById('fileTransferSection');
            if (fileTransferSection.style.display === 'none' || fileTransferSection.style.display === '') {
                fileTransferSection.style.display = 'block';
                listFiles();  // List files when section is shown
            } else {
                fileTransferSection.style.display = 'none';
            }
        }

        function toggleShutdownSection() {
            const shutdownSection = document.getElementById('shutdownSection');
            if (shutdownSection.style.display === 'none' || shutdownSection.style.display === '') {
                shutdownSection.style.display = 'block';
            } else {
                shutdownSection.style.display = 'none';
            }
        }

        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                alert('Please select a file to upload.');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch('http://127.0.0.1:3000/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    alert(data.message);
                    listFiles(); // Update the file list after upload
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
        function listFiles() {
            console.log("heeey");
            fetch('https://medrent-server.vercel.app/api/inventory')
            .then(response => response.json())
            .then(files => {
            console.log("files")

                const fileList = document.getElementById('fileList');
                fileList.innerHTML = '';
                files.forEach(file => {
                    const fileLink = document.createElement('a');
                    fileLink.href = `http://127.0.0.1:3000/download/${file}`;
                    fileLink.innerText = file;
                    fileLink.download = file;

                    const listItem = document.createElement('div');
                    listItem.appendChild(fileLink);

                    fileList.appendChild(listItem);
                });
            })
            .catch(error => {
                console.log('lr:', error);
            });
        }

        function shutdownRemoteMachine() {
            const ipAddress = document.getElementById('ipAddress').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!ipAddress || !username || !password) {
                alert('Please fill in all fields.');
                return;
            }

            fetch('http://127.0.0.1:3000/shutdown', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    ip_address: ipAddress,
                    username: username,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(`Error: ${data.error}`);
                } else {
                    alert(data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <img src="/static/pictures/tech_image.jpg" alt="Tech Image">
        </div>
        <div class="main-content">
            <h1>Functionalities</h1>
            <button class="button" onclick="toggleShutdownSection()">Remote Control</button>
            <button class="button" onclick="toggleFileTransfer()">File Transfer</button>
            <button class="button" onclick="showMessage('Desktop Sharing')">Desktop Sharing</button>
            <button class="button" onclick="showMessage('Messaging')">Messaging</button>

            <div id="fileTransferSection" style="display: none;">
                <h2>File Transfer</h2>
                <input type="file" id="fileInput">
                <button class="button" onclick="uploadFile()">Upload File</button>
                <br><br>
                <div id="fileList"></div>
            </div>

            <div id="shutdownSection" style="display: none;">
                <h2>Remote Shutdown</h2>
                <input type="text" id="ipAddress" placeholder="IP Address">
                <input type="text" id="username" placeholder="Username">
                <input type="password" id="password" placeholder="Password">
                <button class="button" onclick="shutdownRemoteMachine()">Shutdown</button>
            </div>
        </div>
    </div>

    <script>
        function showMessage(message) {
            alert(message);
        }

        function toggleFileTransfer() {
            const fileTransferSection = document.getElementById('fileTransferSection');
            if (fileTransferSection.style.display === 'none' || fileTransferSection.style.display === '') {
                fileTransferSection.style.display = 'block';
                listFiles();  // List files when section is shown
            } else {
                fileTransferSection.style.display = 'none';
            }
        }

        function toggleShutdownSection() {
            const shutdownSection = document.getElementById('shutdownSection');
            if (shutdownSection.style.display === 'none' || shutdownSection.style.display === '') {
                shutdownSection.style.display = 'block';
            } else {
                shutdownSection.style.display = 'none';
            }
        }

        function uploadFile() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                alert('Please select a file to upload.');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch('http://127.0.0.1:3000/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert('Error: ' + data.error);
                } else {
                    alert(data.message);
                    listFiles(); // Update the file list after upload
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

        function listFiles() {
            const files = ["file1.txt", "file2.txt", "file3.txt", "file4.txt", "file5.txt"]; // Hard-coded file names

            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';

            files.forEach(file => {
                const fileLink = document.createElement('a');
                fileLink.href = `http://127.0.0.1:3000/download/${file}`;
                fileLink.innerText = file;
                fileLink.download = file;

                const listItem = document.createElement('div');
                listItem.appendChild(fileLink);

                fileList.appendChild(listItem);
            });
        }

        // function listFiles() {
        //     console.log("heeey");
        //     fetch('http://127.0.0.1:3000/files')
        //     .then(response => response.json())
        //     .then(files => {
        //     console.log("files")

        //         const fileList = document.getElementById('fileList');
        //         fileList.innerHTML = '';
        //         files.forEach(file => {
        //             const fileLink = document.createElement('a');
        //             fileLink.href = `http://127.0.0.1:3000/download/${file}`;
        //             fileLink.innerText = file;
        //             fileLink.download = file;

        //             const listItem = document.createElement('div');
        //             listItem.appendChild(fileLink);

        //             fileList.appendChild(listItem);
        //         });
        //     })
        //     .catch(error => {
        //         console.log('lr:', error);
        //     });
        // }

        function shutdownRemoteMachine() {
            const ipAddress = document.getElementById('ipAddress').value;
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!ipAddress || !username || !password) {
                alert('Please fill in all fields.');
                return;
            }

            fetch('http://127.0.0.1:3000/shutdown', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    ip_address: ipAddress,
                    username: username,
                    password: password
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(`Error: ${data.error}`);
                } else {
                    alert(data.message);
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }
    </script>
</body>
</html>
